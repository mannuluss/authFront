"use strict";(self.webpackChunkauth=self.webpackChunkauth||[]).push([[34],{2034:(T,f,i)=>{i.r(f),i.d(f,{AuthModule:()=>Z});var p=i(6895),a=i(8996),u=i(2340),t=i(4650),h=i(529);class g{constructor(){this.roles=[]}}let C=(()=>{class o{constructor(n,e){this.http=n,this.router=e}get usuario(){return null!=this._usuario?this._usuario:null==this._usuario&&null!=sessionStorage.getItem("usuario")?(this._usuario=JSON.parse(sessionStorage.getItem("usuario")),this._usuario):new g}get token(){return null!=this._token?this._token:null==this._token&&null!=sessionStorage.getItem("token")?(this._token=sessionStorage.getItem("token"),this._token):null}login(n){const e=`${u.N.urlBackAuth}oauth/token`,l=btoa("angularapp:12345"),d=new h.WM({"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic "+l});let c=new URLSearchParams;return c.set("grant_type","password"),c.set("username",n.username),c.set("password",n.password),this.http.post(e,c.toString(),{headers:d})}guardarUsuario(n){let e=this.obtenerDatosToken(n);this._usuario=new g,this._usuario.nombre=e.nombre,this._usuario.apellido=e.apellido,this._usuario.email=e.email,this._usuario.username=e.user_name,this._usuario.roles=e.authorities,sessionStorage.setItem("usuario",JSON.stringify(this._usuario))}guardarToken(n){this._token=n,sessionStorage.setItem("token",n)}obtenerDatosToken(n){return null!=n?JSON.parse(atob(n.split(".")[1])):null}isAuthenticated(){let n=this.obtenerDatosToken(this.token);return!!(null!=n&&n.user_name&&n.user_name.length>0)}hasRole(n){return!!this.usuario.roles.includes(n)}logout(){this._token=null,this._usuario=null,sessionStorage.clear(),sessionStorage.removeItem("token"),sessionStorage.removeItem("usuario")}}return o.\u0275fac=function(n){return new(n||o)(t.LFG(h.eN),t.LFG(a.F0))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var O=i(4859),_=i(7392);let M=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["svg-solsticio"]],decls:8,vars:0,consts:[["version","1.1","id","Layer_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","x","0px","y","0px","viewBox","0 0 8503.94 4251.97",0,"xml","space","preserve",2,"enable-background","new 0 0 8503.94 4251.97"],["type","text/css"],["id","fondo","points","9078.53,4251.97 -882.38,4251.97 -882.38,2125.98 -882.38,0 9078.53,0 ",1,"st0"],["id","eclipse","cx","4251.97","cy","566.93","r","10%",1,"st1"],["id","mount2","d","M7805.43,2353.12c82.35-78.26,208.44-66.45,277.29,25.75c38.09,51.01,75.33,105.74,111.04,164.41\n\tc398.74,655.09,924.48,1382.38,882.38,1708.68H3332.49l2073.92-1450.73c140.13-98.02,320.39-98.65,461.1-1.59l712.13,491.18\n\tc74.39,51.31,169.93,49.88,242.97-3.64L7805.43,2353.12z",1,"st2"],["id","mount","d","M1078.59,2864.84l568.3,510.69c98.67,88.67,236.05,86.7,332.85-4.78l456.6-431.47\n\tc72.25-68.27,177.37-74.46,255.63-14.74c207.13,158.07,482.66,505.17,754.12,690.98c500.94,342.88,1414.65,579.57,1529.58,816.19\n\tH-882.38c143.81-262.61,516.33-523.77,871.8-862.54c353.96-337.33,530.37-537.55,829.67-749.65\n\tC898.18,2763.47,1004.47,2798.23,1078.59,2864.84z",1,"st3"]],template:function(n,e){1&n&&(t._uU(0,'<?xml version="1.0" encoding="utf-8"?>\n'),t.O4$(),t.TgZ(1,"svg",0)(2,"style",1),t._uU(3," .st0{fill:#454546;stroke:#000000;stroke-width:1.0823;stroke-miterlimit:10;} .st1{fill:#FFFFFF;stroke:#000000;stroke-width:1.951;stroke-miterlimit:10;} .st2{fill:#252525;stroke:#000000;stroke-width:1.8039;stroke-miterlimit:10;} .st3{fill:#222222;stroke:#000000;stroke-width:1.926;stroke-miterlimit:10;}\n"),t.qZA(),t._UZ(4,"polygon",2)(5,"circle",3)(6,"path",4)(7,"path",5),t.qZA())},encapsulation:2}),o})(),v=(()=>{class o{constructor(n,e){this.Auth=n,this.router=e}get svgElement(){return document.querySelector("#Group")}ngOnInit(){console.log("log out....."),this.Auth.logout()}exit(){window.location.href=u.N.urlFrontUser}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(C),t.Y36(a.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-logout"]],decls:8,vars:0,consts:[[1,"msj-logout"],["mat-raised-button","",3,"click"]],template:function(n,e){1&n&&(t._UZ(0,"svg-solsticio"),t.TgZ(1,"div",0)(2,"span"),t._uU(3,"LOGOUT"),t.qZA(),t.TgZ(4,"button",1),t.NdJ("click",function(){return e.exit()}),t.TgZ(5,"mat-icon"),t._uU(6,"exit_to_app"),t.qZA(),t._uU(7," Exit "),t.qZA()())},dependencies:[O.lW,_.Hw,M],styles:[".msj-logout[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;color:#252525;text-align:center;font-size:150px;display:flex;flex-direction:column;align-items:center;justify-content:center}.msj-logout[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transform:scale(0);animation:mensaje 1s 3s forwards}.msj-logout[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:100px;color:#ffffffde;background-color:#252525}  svg{position:absolute;left:0;bottom:0;height:100%;width:100%}  #eclipse{fill:#fbcc24;animation:solticio 3s .5s forwards}@keyframes solticio{0%{fill:#fbc80e}33%{translate:0% 100%;r:10%;fill:#fe9900}34%{fill:#f0f8ff}66%{fill:#f0f8ff;translate:0% 20%;r:10%}to{fill:#f0f8ff;transform-origin:50% 5%;r:100%}}@keyframes mensaje{0%{transform:scale(0)}to{transform:scale(1)}}"]}),o})();var s=i(4006),x=i(7009),m=i(3546),P=i(9549),y=i(1572);function k(o,r){1&o&&t._UZ(0,"mat-spinner",13)}function b(o,r){if(1&o&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&o){const n=t.oxw();t.xp6(1),t.Oqu(n.errorLogin)}}const w=[{path:"",children:[{path:"login",component:(()=>{class o{constructor(n,e,l,d,c){this.router=n,this.fb=e,this.authService=l,this.ngZone=d,this._snackBar=c,this.formSubmitted=!1,this.siging=!1,this.errorLogin=void 0,this.loginForm=this.fb.group({Usuario:[null,[s.kI.required,s.kI.email]],password:[null,s.kI.required],remember:[!1]}),this.usuario=new g}ngOnInit(){this.authService.isAuthenticated()&&(console.log("ya esta logueado"),this.redirect(this.authService.usuario))}login(){this.usuario.username=this.loginForm.value.Usuario,this.usuario.password=this.loginForm.value.password,null!=this.usuario?.username&&null!=this.usuario?.password?(this.siging=!0,this.errorLogin=void 0,this.authService.login(this.usuario).subscribe(n=>{console.log(n),this.authService.guardarUsuario(n.access_token),this.authService.guardarToken(n.access_token),this.redirect(this.authService.usuario)},n=>{this.errorLogin="contrase\xf1a o usuario incorrectas.",this.siging=!1})):console.log("credenciales vacias")}redirect(n){n?.roles?.includes("ROLE_ADMIN")?location.href=u.N.urlFrontAdmin:location.href=u.N.urlFrontUser}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(a.F0),t.Y36(s.qu),t.Y36(C),t.Y36(t.R0b),t.Y36(x.ux))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-login"]],decls:22,vars:3,consts:[["src","./assets/man.png","alt","","width","200px"],["autocomplete","off","id","loginform",1,"form-horizontal","form-material",3,"formGroup"],[1,"col-form"],[1,"form-group"],["type","text","placeholder","Usuario","formControlName","Usuario",1,"form-control"],["type","password","placeholder","Password","formControlName","password",1,"form-control"],[1,"col-xs-12","login-btn"],["mat-raised-button","","type","submit",1,"btn","btn-secondary","btn-lg","btn-block","text-uppercase","btn-rounded",3,"click"],[1,"center"],["diameter","40","mode","indeterminate",4,"ngIf"],[4,"ngIf"],[1,"col-sm-12","text-center"],["routerLink","/auth/registro",1,"text-primary","m-l-5"],["diameter","40","mode","indeterminate"]],template:function(n,e){1&n&&(t.TgZ(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),t._UZ(3,"img",0),t.qZA()(),t.TgZ(4,"mat-card-content")(5,"form",1)(6,"div",2)(7,"div",3),t._UZ(8,"input",4),t.qZA(),t.TgZ(9,"div",3),t._UZ(10,"input",5),t.qZA(),t.TgZ(11,"div",6)(12,"button",7),t.NdJ("click",function(){return e.login()}),t._uU(13," Ingresar "),t.qZA()(),t.TgZ(14,"div",8),t.YNc(15,k,1,0,"mat-spinner",9),t.YNc(16,b,2,1,"mat-error",10),t.qZA(),t.TgZ(17,"div",11),t._uU(18," No tienes una cuenta? "),t.TgZ(19,"a",12)(20,"b"),t._uU(21,"Registrarse"),t.qZA()()()()()()()),2&n&&(t.xp6(5),t.Q6J("formGroup",e.loginForm),t.xp6(10),t.Q6J("ngIf",e.siging),t.xp6(1),t.Q6J("ngIf",e.errorLogin))},dependencies:[p.O5,a.yS,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,O.lW,m.a8,m.dk,m.dn,m.n5,P.TO,y.Ou],styles:["mat-card[_ngcontent-%COMP%]{width:400px;padding:40px;border-radius:10px}mat-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px;display:flex;justify-content:center}mat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}mat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{width:100%}mat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .col-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:1rem}mat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .col-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:1rem}mat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .col-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:.5rem}mat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .col-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:15px;border:1px solid #ccc;border-radius:4px}mat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .col-form[_ngcontent-%COMP%]   .login-btn[_ngcontent-%COMP%]{display:flex;justify-content:center}mat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .col-form[_ngcontent-%COMP%]   .login-btn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:15px;background-color:#28960c;color:#fff;font-weight:700}mat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .col-form[_ngcontent-%COMP%]   .center[_ngcontent-%COMP%]{display:flex;justify-content:center}"]}),o})()},{path:"registro",component:(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-registro"]],decls:2,vars:0,template:function(n,e){1&n&&(t.TgZ(0,"p"),t._uU(1,"registro works!"),t.qZA())},encapsulation:2}),o})()},{path:"logout",component:v},{path:"**",redirectTo:"login"}]}];let S=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[a.Bz.forChild(w),a.Bz]}),o})();var A=i(7229);let Z=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[p.ez,S,s.u5,s.UX,A.q]}),o})()}}]);